angular.module("ngDraggable",[]).directive("ngDrag",["$rootScope","$parse",function(e,t){return{restrict:"A",link:function(n,r,i){n.value=i.ngDrag;var s,o=false,u,a,f,l,c,h;var p="ontouchstart"in document.documentElement;var d="touchstart mousedown";var v="touchmove mousemove";var m="touchend mouseup";var g=$(document);var y=$(window);var b=null;var w=false;var E=null;var S=t(i.ngDragSuccess)||null;var x=function(){r.attr("draggable","false");T(true)};var T=function(e){if(!e)return;n.$on("$destroy",N);n.$watch(i.ngDrag,k);n.$watch(i.ngCenterAnchor,L);n.$watch(i.ngDragData,C);r.on(d,A);if(!p){r.on("mousedown",function(){return false})}};var N=function(e){T(false)};var C=function(e,t){b=e};var k=function(e,t){w=e};var L=function(e,t){if(angular.isDefined(e))o=e||"true"};var A=function(e){if(!w)return;if(p){O();E=setTimeout(function(){O();M(e)},100);g.on(v,O);g.on(m,O)}else{M(e)}};var O=function(){clearTimeout(E);g.off(v,O);g.off(m,O)};var M=function(t){if(!w)return;t.preventDefault();s=r.offset();r.centerX=r.width()/2;r.centerY=r.height()/2;r.addClass("dragging");u=t.pageX||t.originalEvent.touches[0].pageX;a=t.pageY||t.originalEvent.touches[0].pageY;c=u-s.left;h=a-s.top;if(o){f=u-r.centerX-y.scrollLeft();l=a-r.centerY-y.scrollTop()}else{f=s.left-y.scrollLeft();l=s.top-y.scrollTop()}B(f,l);g.on(v,_);g.on(m,D);e.$broadcast("draggable:start",{x:u,y:a,tx:f,ty:l,event:t,element:r,data:b})};var _=function(t){if(!w)return;t.preventDefault();u=t.pageX||t.originalEvent.touches[0].pageX;a=t.pageY||t.originalEvent.touches[0].pageY;if(o){f=u-r.centerX-y.scrollLeft();l=a-r.centerY-y.scrollTop()}else{f=u-c-y.scrollLeft();l=a-h-y.scrollTop()}B(f,l);e.$broadcast("draggable:move",{x:u,y:a,tx:f,ty:l,event:t,element:r,data:b})};var D=function(t){if(!w)return;t.preventDefault();e.$broadcast("draggable:end",{x:u,y:a,tx:f,ty:l,event:t,element:r,data:b,callback:P});r.removeClass("dragging");H();g.off(v,_);g.off(m,D)};var P=function(e){if(!S)return;n.$apply(function(){S(n,{$data:b,$event:e})})};var H=function(){r.css({left:"",top:"",position:"","z-index":"",margin:""})};var B=function(e,t){r.css({left:e,top:t,position:"fixed","z-index":99999,margin:"0"})};x()}}}]).directive("ngDrop",["$parse","$timeout",function(e,t){return{restrict:"A",link:function(n,r,i){n.value=i.ngDrop;var s=false;var o=e(i.ngDropSuccess);var u=function(){a(true)};var a=function(e){if(!e)return;i.$observe("ngDrop",l);n.$on("$destroy",f);n.$on("draggable:start",c);n.$on("draggable:move",h);n.$on("draggable:end",p)};var f=function(e){a(false)};var l=function(e,t){s=n.$eval(e)};var c=function(e,t){if(!s)return;d(t.x,t.y,t.element)};var h=function(e,t){if(!s)return;d(t.x,t.y,t.element)};var p=function(e,r){if(!s)return;if(d(r.x,r.y,r.element)){if(r.callback){r.callback(r)}t(function(){o(n,{$data:r.data,$event:r})})}v(false,r.element)};var d=function(e,t,n){var r=m(e,t);v(r,n);return r};var v=function(e,t){if(e){r.addClass("drag-enter");t.addClass("drag-over")}else{r.removeClass("drag-enter");t.removeClass("drag-over")}};var m=function(e,t){var n=r.offset();n.right=n.left+r.outerWidth();n.bottom=n.top+r.outerHeight();return e>=n.left&&e<=n.right&&t<=n.bottom&&t>=n.top};u()}}}]).directive("ngDragClone",["$parse","$timeout",function(e,t){return{restrict:"A",link:function(e,t,n){var r,i=true;e.clonedData={};var s=function(){r=$(t.find("img"));t.attr("draggable","false");r.attr("draggable","false");c();o(true)};var o=function(t){if(!t)return;e.$on("draggable:start",a);e.$on("draggable:move",f);e.$on("draggable:end",l);u()};var u=function(){r.off("mousedown touchstart touchmove touchend touchcancel",p);r.on("mousedown touchstart touchmove touchend touchcancel",p)};var a=function(n,r,s){i=true;if(angular.isDefined(r.data.allowClone)){i=r.data.allowClone}if(i){e.$apply(function(){e.clonedData=r.data});t.css("width",r.element.width());t.css("height",r.element.height());h(r.tx,r.ty)}};var f=function(e,t){if(i){h(t.tx,t.ty)}};var l=function(e,t){if(i){c()}};var c=function(){t.css({left:0,top:0,position:"fixed","z-index":-1,visibility:"hidden"})};var h=function(e,n){t.css({left:e,top:n,position:"fixed","z-index":99999,visibility:"visible"})};var p=function(e){var t=e.originalEvent;t.preventDefault&&t.preventDefault();t.stopPropagation&&t.stopPropagation();t.cancelBubble=true;t.returnValue=false;return false};s()}}}]).directive("ngPreventDrag",["$parse","$timeout",function(e,t){return{restrict:"A",link:function(e,t,n){var r=function(){t.attr("draggable","false");i(true)};var i=function(e){if(!e)return;t.on("mousedown touchstart touchmove touchend touchcancel",s)};var s=function(e){var t=e.originalEvent;t.preventDefault&&t.preventDefault();t.stopPropagation&&t.stopPropagation();t.cancelBubble=true;t.returnValue=false;return false};r()}}}])